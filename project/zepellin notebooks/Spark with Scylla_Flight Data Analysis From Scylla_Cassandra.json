{"paragraphs":[{"title":"Adding Dependencies","text":"%spark.dep\nz.reset() // clean up previously added artifact and repository\n// add artifact recursively\nz.load(\"datastax:spark-cassandra-connector:2.3.0-s_2.11\")\nz.load(\"commons-configuration:commons-configuration:1.10\")","user":"anonymous","dateUpdated":"2019-01-23T14:36:59+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@221dd449\n"}]},"apps":[],"jobName":"paragraph_1548231524558_-1105138565","id":"20190123-134844_1810449358","dateCreated":"2019-01-23T13:48:44+0530","dateStarted":"2019-01-23T13:49:40+0530","dateFinished":"2019-01-23T13:49:59+0530","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8438"},{"text":"%spark\nimport com.datastax.spark.connector._\nimport org.apache.spark.sql.cassandra._\n","user":"anonymous","dateUpdated":"2019-01-23T13:49:55+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.datastax.spark.connector._\nimport org.apache.spark.sql.cassandra._\n"}]},"apps":[],"jobName":"paragraph_1548231580537_891803033","id":"20190123-134940_1336429459","dateCreated":"2019-01-23T13:49:40+0530","dateStarted":"2019-01-23T13:49:55+0530","dateFinished":"2019-01-23T13:50:11+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8439"},{"title":"Create a DataFrame from Cassandra/Scylla Source","text":"%spark\nval flights = spark.read.cassandraFormat(\"flights\", \"flight_data\").load()\n","user":"anonymous","dateUpdated":"2019-01-23T14:16:02+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"flights: org.apache.spark.sql.DataFrame = [AIRLINE: string, YEAR: int ... 29 more fields]\n"}]},"apps":[],"jobName":"paragraph_1548231595817_1466803761","id":"20190123-134955_970727771","dateCreated":"2019-01-23T13:49:55+0530","dateStarted":"2019-01-23T13:51:27+0530","dateFinished":"2019-01-23T13:51:30+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8440"},{"title":"Print Schema","text":"%spark\nflights.printSchema","user":"anonymous","dateUpdated":"2019-01-23T14:16:37+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- AIRLINE: string (nullable = true)\n |-- YEAR: integer (nullable = true)\n |-- MONTH: integer (nullable = true)\n |-- DAY: integer (nullable = true)\n |-- SCHEDULED_DEPARTURE: integer (nullable = true)\n |-- AIRLINE_DELAY: integer (nullable = true)\n |-- AIR_SYSTEM_DELAY: integer (nullable = true)\n |-- AIR_TIME: integer (nullable = true)\n |-- ARRIVAL_DELAY: integer (nullable = true)\n |-- ARRIVAL_TIME: integer (nullable = true)\n |-- CANCELLATION_REASON: string (nullable = true)\n |-- CANCELLED: integer (nullable = true)\n |-- DAY_OF_WEEK: integer (nullable = true)\n |-- DEPARTURE_DELAY: integer (nullable = true)\n |-- DEPARTURE_TIME: integer (nullable = true)\n |-- DESTINATION_AIRPORT: string (nullable = true)\n |-- DISTANCE: integer (nullable = true)\n |-- DIVERTED: integer (nullable = true)\n |-- ELAPSED_TIME: integer (nullable = true)\n |-- FLIGHT_NUMBER: integer (nullable = true)\n |-- LATE_AIRCRAFT_DELAY: integer (nullable = true)\n |-- ORIGIN_AIRPORT: string (nullable = true)\n |-- SCHEDULED_ARRIVAL: integer (nullable = true)\n |-- SCHEDULED_TIME: integer (nullable = true)\n |-- SECURITY_DELAY: integer (nullable = true)\n |-- TAIL_NUMBER: string (nullable = true)\n |-- TAXI_IN: integer (nullable = true)\n |-- TAXI_OUT: integer (nullable = true)\n |-- WEATHER_DELAY: integer (nullable = true)\n |-- WHEELS_OFF: integer (nullable = true)\n |-- WHEELS_ON: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1548231647671_-341528501","id":"20190123-135047_1272248686","dateCreated":"2019-01-23T13:50:47+0530","dateStarted":"2019-01-23T13:51:44+0530","dateFinished":"2019-01-23T13:51:45+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8441"},{"title":"Apply a filter to find flights delayed more than 15 min","text":"%spark\n// Create a Dataset containing flights with delayed departure by more than 15 min using \"filter\"\nval delayedFlights = (flights\n                        .select(\"AIRLINE\", \"DEPARTURE_DELAY\")\n                        .filter($\"DEPARTURE_DELAY\" > 15))\n                        \ndelayedFlights.show()","user":"anonymous","dateUpdated":"2019-01-23T14:16:57+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"delayedFlights: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [AIRLINE: string, DEPARTURE_DELAY: int]\n+-------+---------------+\n|AIRLINE|DEPARTURE_DELAY|\n+-------+---------------+\n|     OO|             64|\n|     OO|             53|\n|     OO|             21|\n|     OO|             68|\n|     OO|             24|\n|     OO|            244|\n|     OO|            107|\n|     OO|            151|\n|     OO|            121|\n|     OO|             41|\n|     OO|             63|\n|     OO|             92|\n|     OO|             51|\n|     OO|             24|\n|     OO|             48|\n|     OO|             42|\n|     OO|            137|\n|     OO|             59|\n|     OO|             71|\n|     OO|             21|\n+-------+---------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=0","http://192.168.1.70:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548231704922_-218117338","id":"20190123-135144_955923747","dateCreated":"2019-01-23T13:51:44+0530","dateStarted":"2019-01-23T13:52:12+0530","dateFinished":"2019-01-23T13:52:24+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8442"},{"title":"Display percentage of delayed flights","text":"%spark\nval numTotalFlights = flights.count()\nval numDelayedFlights = delayedFlights.count()\n\n// Print total number of delayed flights\nprintln(\"Percentage of Delayed Flights: \" + (numDelayedFlights.toFloat/numTotalFlights*100) + \"%\")","user":"anonymous","dateUpdated":"2019-01-23T14:17:16+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"numTotalFlights: Long = 32403\nnumDelayedFlights: Long = 8914\nPercentage of Delayed Flights: 27.5098%\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=2","http://192.168.1.70:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548231732917_-1558812785","id":"20190123-135212_69164827","dateCreated":"2019-01-23T13:52:12+0530","dateStarted":"2019-01-23T13:52:52+0530","dateFinished":"2019-01-23T13:52:57+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8443"},{"title":" Create a UDF to determine delays","text":"%spark\nimport org.apache.spark.sql.functions.udf\n\n// Define a UDF to find delayed flights\n\n// Assume:\n//  if ArrDelay is not available then Delayed = False\n//  if ArrDelay > 15 min then Delayed = True else False\n\nval isDelayedUDF = udf((DEPARTURE_DELAY: String) => { \n                 try {\n        if (DEPARTURE_DELAY.trim == \"null\") 0 \n                else if (DEPARTURE_DELAY.trim.toInt > 15) 1 \n                else 0\n      } catch {\n         case _  : Throwable =>{\n           0\n         }\n         \n         \n      }\n                \n    \n})","user":"anonymous","dateUpdated":"2019-01-23T14:17:41+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions.udf\nisDelayedUDF: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,IntegerType,Some(List(StringType)))\n"}]},"apps":[],"jobName":"paragraph_1548231772531_1480527080","id":"20190123-135252_1309658380","dateCreated":"2019-01-23T13:52:52+0530","dateStarted":"2019-01-23T13:53:28+0530","dateFinished":"2019-01-23T13:53:30+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8444"},{"title":"Create a new DataFrame with IsDelayed column","text":"%spark\nval flightsWithDelays = flights.select($\"YEAR\", $\"MONTH\", $\"AIRLINE\", $\"FLIGHT_NUMBER\", $\"ORIGIN_AIRPORT\", $\"DEPARTURE_DELAY\", \n                    isDelayedUDF($\"DEPARTURE_DELAY\").alias(\"IsDelayed\"))\n                    \nflightsWithDelays.show(5)","user":"anonymous","dateUpdated":"2019-01-23T14:18:01+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"flightsWithDelays: org.apache.spark.sql.DataFrame = [YEAR: int, MONTH: int ... 5 more fields]\n+----+-----+-------+-------------+--------------+---------------+---------+\n|YEAR|MONTH|AIRLINE|FLIGHT_NUMBER|ORIGIN_AIRPORT|DEPARTURE_DELAY|IsDelayed|\n+----+-----+-------+-------------+--------------+---------------+---------+\n|2015|    1|     OO|         4758|           SLC|             -4|        0|\n|2015|    1|     OO|         5634|           SFO|             -4|        0|\n|2015|    1|     OO|         6476|           SFO|             -5|        0|\n|2015|    1|     OO|         5454|           SMF|              1|        0|\n|2015|    1|     OO|         6310|           LAX|             -2|        0|\n+----+-----+-------+-------------+--------------+---------------+---------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=4","http://192.168.1.70:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548231808880_-1214698433","id":"20190123-135328_1973661478","dateCreated":"2019-01-23T13:53:28+0530","dateStarted":"2019-01-23T13:53:40+0530","dateFinished":"2019-01-23T13:53:43+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8445"},{"title":"Calculate percentage of delayed flights using flightsWithDelays DataFrame","text":"%spark\nflightsWithDelays.agg((sum(\"IsDelayed\") * 100 / count(\"DEPARTURE_DELAY\")).alias(\"Percentage of Delayed Flights\")).show()","user":"anonymous","dateUpdated":"2019-01-23T14:31:43+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------------------+\n|Percentage of Delayed Flights|\n+-----------------------------+\n|           27.509798475449806|\n+-----------------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548231820625_-1174609174","id":"20190123-135340_1743774218","dateCreated":"2019-01-23T13:53:40+0530","dateStarted":"2019-01-23T13:53:55+0530","dateFinished":"2019-01-23T13:53:57+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8446"},{"title":"Find Avg Taxi-in","text":"%spark\n(flights.select(\"ORIGIN_AIRPORT\", \"DESTINATION_AIRPORT\", \"TAXI_IN\")\n        .groupBy(\"ORIGIN_AIRPORT\", \"DESTINATION_AIRPORT\")\n        .agg(avg(\"TAXI_IN\")\n        .alias(\"AVG_TAXI_IN\"))\n        .orderBy(desc(\"AVG_TAXI_IN\"))\n        .show(10))","user":"anonymous","dateUpdated":"2019-01-23T14:32:04+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+-------------------+-----------+\n|ORIGIN_AIRPORT|DESTINATION_AIRPORT|AVG_TAXI_IN|\n+--------------+-------------------+-----------+\n|           RSW|                LBE|       81.0|\n|           LIH|                ORD|       78.0|\n|           XNA|                RDU|       78.0|\n|           XNA|                TXK|       77.0|\n|           SYR|                VPS|       70.0|\n|           BWI|                LAX|       66.0|\n|           OMA|                STL|       65.0|\n|           VPS|                RDU|      62.75|\n|           LIT|                SJT|       58.0|\n|           MEM|                SFO|       58.0|\n+--------------+-------------------+-----------+\nonly showing top 10 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548231835209_-729940646","id":"20190123-135355_1260130755","dateCreated":"2019-01-23T13:53:55+0530","dateStarted":"2019-01-23T13:54:15+0530","dateFinished":"2019-01-23T13:54:20+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8447"},{"title":"Find Avg Taxi-Out","text":"%spark\n(flights.select(\"ORIGIN_AIRPORT\", \"DESTINATION_AIRPORT\", \"TAXI_OUT\")\n        .groupBy(\"ORIGIN_AIRPORT\", \"DESTINATION_AIRPORT\")\n        .agg(avg(\"TAXI_OUT\")\n        .alias(\"AVG_TAXI_OUT\"))\n        .orderBy(desc(\"AVG_TAXI_OUT\"))\n        .show(10))","user":"anonymous","dateUpdated":"2019-01-23T14:32:20+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+-------------------+------------+\n|ORIGIN_AIRPORT|DESTINATION_AIRPORT|AVG_TAXI_OUT|\n+--------------+-------------------+------------+\n|           PHX|                STT|       130.0|\n|           SYR|                BTR|       124.0|\n|           LAS|                SJC|       122.0|\n|           CVG|                LEX|       106.0|\n|           LGA|                GRK|       103.0|\n|           MYR|                JFK|       101.0|\n|           OMA|                SJC|        99.0|\n|           PWM|                SLC|        99.0|\n|           PIT|                FLL|        98.0|\n|           IAD|                BUF|        94.0|\n+--------------+-------------------+------------+\nonly showing top 10 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548231855153_-1324666291","id":"20190123-135415_2004440282","dateCreated":"2019-01-23T13:54:15+0530","dateStarted":"2019-01-23T13:54:39+0530","dateFinished":"2019-01-23T13:54:42+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8448"},{"title":"Register a Temporary View","text":"%spark\n// Convert flights DataFrame to a temporary view\nflights.createOrReplaceTempView(\"flightsView\")","user":"anonymous","dateUpdated":"2019-01-23T14:32:46+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1548231879496_-655579695","id":"20190123-135439_1159778464","dateCreated":"2019-01-23T13:54:39+0530","dateStarted":"2019-01-23T13:55:05+0530","dateFinished":"2019-01-23T13:55:06+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8449"},{"title":"Preview Data in an interactive table format","text":"%spark.sql\n\nSELECT * FROM flightsView LIMIT 20","user":"anonymous","dateUpdated":"2019-01-23T14:33:07+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"AIRLINE":"string","YEAR":"string","MONTH":"string","DAY":"string","SCHEDULED_DEPARTURE":"string","AIRLINE_DELAY":"string","AIR_SYSTEM_DELAY":"string","AIR_TIME":"string","ARRIVAL_DELAY":"string","ARRIVAL_TIME":"string","CANCELLATION_REASON":"string","CANCELLED":"string","DAY_OF_WEEK":"string","DEPARTURE_DELAY":"string","DEPARTURE_TIME":"string","DESTINATION_AIRPORT":"string","DISTANCE":"string","DIVERTED":"string","ELAPSED_TIME":"string","FLIGHT_NUMBER":"string","LATE_AIRCRAFT_DELAY":"string","ORIGIN_AIRPORT":"string","SCHEDULED_ARRIVAL":"string","SCHEDULED_TIME":"string","SECURITY_DELAY":"string","TAIL_NUMBER":"string","TAXI_IN":"string","TAXI_OUT":"string","WEATHER_DELAY":"string","WHEELS_OFF":"string","WHEELS_ON":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"AIRLINE\tYEAR\tMONTH\tDAY\tSCHEDULED_DEPARTURE\tAIRLINE_DELAY\tAIR_SYSTEM_DELAY\tAIR_TIME\tARRIVAL_DELAY\tARRIVAL_TIME\tCANCELLATION_REASON\tCANCELLED\tDAY_OF_WEEK\tDEPARTURE_DELAY\tDEPARTURE_TIME\tDESTINATION_AIRPORT\tDISTANCE\tDIVERTED\tELAPSED_TIME\tFLIGHT_NUMBER\tLATE_AIRCRAFT_DELAY\tORIGIN_AIRPORT\tSCHEDULED_ARRIVAL\tSCHEDULED_TIME\tSECURITY_DELAY\tTAIL_NUMBER\tTAXI_IN\tTAXI_OUT\tWEATHER_DELAY\tWHEELS_OFF\tWHEELS_ON\nOO\t2015\t1\t7\t1615\t47\t0\t202\t-2\t1947\t0\t0\t3\t-4\t1709\tSEA\t1368\t0\t218\t4758\t43\tSLC\t1900\t220\t0\tN899SK\t10\t26\t0\t1718\t1937\nOO\t2015\t1\t7\t1613\t0\t0\t34\t2\t1713\t0\t0\t3\t-4\t1609\tRNO\t192\t0\t64\t5634\t0\tSFO\t1711\t58\t0\tN746SK\t5\t25\t0\t1634\t1708\nOO\t2015\t1\t7\t1610\t0\t0\t206\t-15\t2205\t0\t0\t3\t-5\t1613\tSTL\t1735\t0\t232\t6476\t0\tSFO\t2158\t228\t0\tN956SW\t8\t21\t0\t1631\t2157\nOO\t2015\t1\t7\t1608\t0\t0\t24\t-17\t1643\t0\t0\t3\t1\t1609\tSFO\t86\t0\t34\t5454\t0\tSMF\t1700\t52\t0\tN292SW\t2\t8\t0\t1617\t1641\nOO\t2015\t1\t7\t1606\t0\t0\t70\t-3\t1658\t0\t0\t3\t-2\t1604\tPSP\t373\t0\t83\t6310\t0\tLAX\t1701\t84\t0\tN936SW\t5\t17\t0\t1621\t1653\nOO\t2015\t1\t7\t1605\t24\t15\t164\t27\t2121\t0\t0\t3\t-2\t1629\tTUS\t1235\t0\t198\t6340\t0\tYUM\t2106\t181\t0\tN885AS\t19\t15\t0\t1644\t2102\nOO\t2015\t1\t7\t1604\t0\t0\t29\t57\t1746\t0\t0\t3\t64\t1708\tSAN\t109\t0\t38\t2579\t57\tLAX\t1649\t45\t0\tN464SW\t4\t5\t0\t1713\t1742\nOO\t2015\t1\t7\t1603\t0\t0\t75\t33\t1830\t0\t0\t3\t53\t1656\tMEM\t491\t0\t94\t5219\t33\tORD\t1757\t114\t0\tN952SW\t5\t14\t0\t1710\t1825\nOO\t2015\t1\t7\t1602\t0\t0\t51\t12\t1834\t0\t0\t3\t21\t1623\tCMH\t296\t0\t71\t5169\t0\tORD\t1822\t80\t0\tN932EV\t6\t14\t0\t1637\t1828\nOO\t2015\t1\t7\t1600\t0\t0\t188\t-6\t2054\t0\t0\t3\t-1\t1905\tSFO\t1464\t0\t229\t6335\t175\tSFO\t1759\t239\t0\tN912EV\t26\t20\t0\t1920\t2028\nOO\t2015\t1\t7\t1559\t0\t0\t33\t-11\t1653\t0\t0\t3\t-4\t1555\tFSD\t196\t0\t58\t4714\t0\tMSP\t1704\t65\t0\tN429SW\t4\t21\t0\t1616\t1649\nOO\t2015\t1\t7\t1556\t0\t0\t26\t-19\t1625\t0\t0\t3\t-10\t1546\tMSP\t114\t0\t39\t7374\t0\tBRD\t1644\t48\t0\tN457SW\t5\t8\t0\t1554\t1620\nOO\t2015\t1\t7\t1555\t0\t3\t66\t-5\t1848\t0\t0\t3\t-4\t1740\tORD\t436\t0\t95\t6331\t105\tSLC\t1730\t95\t0\tN982SW\t24\t24\t56\t1749\t1833\nOO\t2015\t1\t7\t1551\t0\t0\t28\t25\t1710\t0\t0\t3\t-4\t1624\tPUB\t125\t0\t53\t5585\t25\tDEN\t1645\t54\t0\tN703SK\t12\t17\t0\t1632\t1700\nOO\t2015\t1\t7\t1550\t0\t0\t198\t-27\t1725\t0\t0\t3\t0\t1550\tSFO\t1482\t0\t215\t6412\t0\tSAT\t1752\t242\t0\tN108SY\t3\t14\t0\t1604\t1722\nOO\t2015\t1\t7\t1549\t0\t0\t25\t60\t1738\t0\t0\t3\t68\t1657\tPDX\t129\t0\t41\t4491\t60\tSEA\t1638\t49\t0\tN641CA\t4\t12\t0\t1709\t1734\nOO\t2015\t1\t7\t1547\t0\t0\t37\t-15\t1649\t0\t0\t3\t-2\t1545\tMSP\t190\t0\t64\t7416\t0\tRHI\t1647\t60\t0\tN437SW\t10\t22\t0\t1607\t1644\nOO\t2015\t1\t7\t1545\t0\t5\t105\t29\t1724\t0\t0\t3\t24\t1609\tORD\t612\t0\t135\t6446\t24\tDCA\t1655\t130\t0\tN110SY\t10\t20\t0\t1629\t1714\nOO\t2015\t1\t7\t1544\t0\t0\t32\t-2\t1547\t0\t0\t3\t0\t1544\tORD\t157\t0\t63\t5345\t0\tFWA\t1549\t65\t0\tN701BR\t19\t12\t0\t1556\t1528\nOO\t2015\t1\t7\t1543\t99\t0\t59\t-22\t1834\t0\t0\t3\t-8\t1734\tSMF\t373\t0\t75\t7367\t0\tLAX\t1712\t89\t0\tN932SW\t6\t12\t0\t1746\t1828\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=9","http://192.168.1.70:4040/jobs/job?id=10"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548231905740_-1819456477","id":"20190123-135505_298686193","dateCreated":"2019-01-23T13:55:05+0530","dateStarted":"2019-01-23T13:55:19+0530","dateFinished":"2019-01-23T13:55:20+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8450"},{"title":"Register a User Defined Function (UDF)","text":"%spark\n\n// Register a helper UDF to find delayed flights\n// Note that this is a UDF specific for use with the sparkSession\n\n// Assume:\n//  if ArrDelay is not available then Delayed = False\n//  if ArrDelay > 15 min then Delayed = True else False\n\nval isDelayedUDF = (DEPARTURE_DELAY: String) => { \n                 try {\n        if (DEPARTURE_DELAY.trim == \"null\") 0 \n                else if (DEPARTURE_DELAY.trim.toInt > 15) 1 \n                else 0\n      } catch {\n         case _  : Throwable =>{\n           0\n         }\n         \n         \n      }\n                \n    \n}\nspark.udf.register(\"isDelayedUDF\", isDelayedUDF )","user":"anonymous","dateUpdated":"2019-01-23T14:33:34+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"isDelayedUDF: String => Int = <function1>\nres41: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(<function1>,IntegerType,Some(List(StringType)))\n"}]},"apps":[],"jobName":"paragraph_1548231919665_1320854901","id":"20190123-135519_780358540","dateCreated":"2019-01-23T13:55:19+0530","dateStarted":"2019-01-23T13:56:47+0530","dateFinished":"2019-01-23T13:56:48+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8451"},{"title":"Compare Total Number of Delayed Flights by Carrier","text":"%spark.sql\n--- Compare Total Number of Delayed Flights by Carrier\nSELECT AIRLINE, SUM(isDelayedUDF(DEPARTURE_DELAY)) AS NumDelays FROM flightsView GROUP BY AIRLINE","user":"anonymous","dateUpdated":"2019-01-23T14:33:57+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"AIRLINE":"string","NumDelays":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"AIRLINE\tNumDelays\nUA\t1750\nNK\t611\nAA\t548\nEV\t1195\nB6\t772\nDL\t629\nOO\t1151\nF9\t466\nUS\t253\nMQ\t661\nHA\t210\nAS\t171\nVX\t101\nWN\t396\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=11","http://192.168.1.70:4040/jobs/job?id=12","http://192.168.1.70:4040/jobs/job?id=13","http://192.168.1.70:4040/jobs/job?id=14","http://192.168.1.70:4040/jobs/job?id=15"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548231951953_1645602877","id":"20190123-135551_462935034","dateCreated":"2019-01-23T13:55:51+0530","dateStarted":"2019-01-23T13:56:51+0530","dateFinished":"2019-01-23T13:56:53+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8452"},{"title":"Compare Total Delayed Time (min) by Carrier","text":"%spark.sql\n--- Compare Total Delayed Time (min) by Carrier\nSELECT AIRLINE, SUM(DEPARTURE_DELAY) AS TotalTimeDelay FROM flightsView GROUP BY AIRLINE","user":"anonymous","dateUpdated":"2019-01-23T15:09:19+0530","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"AIRLINE":"string","TotalTimeDelay":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-90"},"xLabelStatus":"default","stacked":true}},"commonSetting":{},"keys":[{"name":"AIRLINE","index":0,"aggr":"sum"}],"groups":[{"name":"AIRLINE","index":0,"aggr":"sum"}],"values":[{"name":"TotalTimeDelay","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"AIRLINE\tTotalTimeDelay\nUA\t117539\nNK\t41050\nAA\t41187\nEV\t87705\nB6\t48889\nDL\t34744\nOO\t78293\nF9\t36968\nUS\t15722\nMQ\t56390\nHA\t9330\nAS\t5996\nVX\t5259\nWN\t29546\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=21","http://192.168.1.70:4040/jobs/job?id=22","http://192.168.1.70:4040/jobs/job?id=23","http://192.168.1.70:4040/jobs/job?id=24","http://192.168.1.70:4040/jobs/job?id=25"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548231977324_-785171093","id":"20190123-135617_1222972811","dateCreated":"2019-01-23T13:56:17+0530","dateStarted":"2019-01-23T14:00:22+0530","dateFinished":"2019-01-23T14:00:24+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8453"},{"title":"Find Average Distance Travelled by Carrier","text":"%spark.sql\n--- Find Average Distance Travelled by Carrier\nSELECT AIRLINE, avg(DISTANCE) AS AvgDistanceTraveled FROM flightsView GROUP BY AIRLINE ORDER BY AvgDistanceTraveled DESC","user":"anonymous","dateUpdated":"2019-01-23T15:09:19+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"AIRLINE":"string","AvgDistanceTraveled":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true}},"commonSetting":{},"keys":[{"name":"AIRLINE","index":0,"aggr":"sum"}],"groups":[{"name":"AIRLINE","index":0,"aggr":"sum"}],"values":[{"name":"AvgDistanceTraveled","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"AIRLINE\tAvgDistanceTraveled\nVX\t1616.771137026239\nUA\t1565.2681142317679\nAS\t1464.991156963891\nAA\t1351.1056499770327\nUS\t1250.4145534729878\nB6\t1210.9117210682493\nDL\t1158.7919359007496\nWN\t1076.6004480955937\nNK\t1045.9147920927062\nF9\t970.6472196900638\nHA\t618.9776674937965\nOO\t617.1539551357733\nEV\t600.2334241598546\nMQ\t587.0264317180616\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=26"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548232077469_312936290","id":"20190123-135757_1501081375","dateCreated":"2019-01-23T13:57:57+0530","dateStarted":"2019-01-23T14:00:23+0530","dateFinished":"2019-01-23T14:00:26+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8454"},{"title":"Find Out When Most Flights Get Delayed by Day of Week","text":"%spark.sql\n\nSELECT DAY_OF_WEEK, CASE WHEN isDelayedUDF(DEPARTURE_DELAY) = 1 THEN 'delayed' ELSE 'ok' END AS Delay, COUNT(1) AS Count\nFROM flightsView\nGROUP BY DAY_OF_WEEK, CASE WHEN isDelayedUDF(DEPARTURE_DELAY) = 1 THEN 'delayed' ELSE 'ok' END\nORDER BY DAY_OF_WEEK\n","user":"anonymous","dateUpdated":"2019-01-23T15:09:20+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"DAY_OF_WEEK":"string","Delay":"string","Count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"DAY_OF_WEEK","index":0,"aggr":"sum"}],"groups":[{"name":"Delay","index":1,"aggr":"sum"}],"values":[{"name":"Count","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DAY_OF_WEEK\tDelay\tCount\n1\tok\t3475\n1\tdelayed\t1423\n2\tok\t3715\n2\tdelayed\t1427\n3\tdelayed\t700\n3\tok\t2720\n4\tdelayed\t723\n4\tok\t3785\n5\tok\t3901\n5\tdelayed\t1016\n6\tdelayed\t1666\n6\tok\t3026\n7\tok\t2867\n7\tdelayed\t1959\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=27"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548232222506_-1841346966","id":"20190123-140022_450392398","dateCreated":"2019-01-23T14:00:22+0530","dateStarted":"2019-01-23T14:01:08+0530","dateFinished":"2019-01-23T14:01:10+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8455"},{"title":"Find Out When Most Flights Get Delayed by Hour","text":"%spark.sql\n\nSELECT CAST(DEPARTURE_TIME / 100 AS INT) AS Hour, CASE WHEN isDelayedUDF(DEPARTURE_DELAY) = 1 THEN 'delayed' ELSE 'ok' END AS Delay, COUNT(1) AS Count\nFROM flightsView\nGROUP BY CAST(DEPARTURE_TIME / 100 AS INT), CASE WHEN isDelayedUDF(DEPARTURE_DELAY) = 1 THEN 'delayed' ELSE 'ok' END\nORDER BY Hour","user":"anonymous","dateUpdated":"2019-01-23T15:09:20+0530","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Hour":"string","Delay":"string","Count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","style":"stack"}},"commonSetting":{},"keys":[{"name":"Hour","index":0,"aggr":"sum"}],"groups":[{"name":"Delay","index":1,"aggr":"sum"}],"values":[{"name":"Count","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Hour\tDelay\tCount\n0\tok\t481\n0\tdelayed\t101\n1\tok\t126\n1\tdelayed\t61\n2\tdelayed\t33\n2\tok\t31\n3\tdelayed\t21\n3\tok\t11\n4\tdelayed\t12\n4\tok\t57\n5\tdelayed\t28\n5\tok\t577\n6\tok\t1319\n6\tdelayed\t68\n7\tdelayed\t145\n7\tok\t1447\n8\tdelayed\t214\n8\tok\t1571\n9\tdelayed\t269\n9\tok\t1565\n10\tok\t1645\n10\tdelayed\t387\n11\tok\t1586\n11\tdelayed\t434\n12\tok\t1479\n12\tdelayed\t505\n13\tdelayed\t537\n13\tok\t1548\n14\tok\t1430\n14\tdelayed\t581\n15\tdelayed\t665\n15\tok\t1398\n16\tdelayed\t736\n16\tok\t1214\n17\tok\t1205\n17\tdelayed\t617\n18\tok\t1032\n18\tdelayed\t668\n19\tok\t995\n19\tdelayed\t686\n20\tok\t938\n20\tdelayed\t607\n21\tdelayed\t583\n21\tok\t771\n22\tok\t615\n22\tdelayed\t546\n23\tdelayed\t406\n23\tok\t445\n24\tok\t3\n24\tdelayed\t4\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.70:4040/jobs/job?id=28"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1548232268263_1971051111","id":"20190123-140108_1435218491","dateCreated":"2019-01-23T14:01:08+0530","dateStarted":"2019-01-23T14:02:48+0530","dateFinished":"2019-01-23T14:02:50+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8456"}],"name":"Spark with Scylla/Flight Data Analysis From Scylla/Cassandra","id":"2E41U7U42","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[],"cassandra:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}